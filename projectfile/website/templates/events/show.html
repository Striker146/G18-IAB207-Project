{% extends 'base.html' %}
{% from 'bootstrap5/form.html' import render_form %}

{% block content %}
<div class="padding"></div>
<div class="container bottom_padding">
  <div class="row d-flex justify-content-center">
    <div class="col-12  col-sm-12 col-md-6">
      <div id="carouselExampleAutoplaying" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner w-20">
          <div class="carousel-item active">
            <img src="{{ url_for('static', filename=event.images[0].filepath) }}" class="d-block w-100 rounded"
              alt="...">
          </div>
          {%for image in event.images[1:]%}
          <div class="carousel-item">
            <img src="{{ url_for('static', filename=image.filepath) }}" class="d-block w-100 rounded" alt="...">
          </div>
          {%endfor%}
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleAutoplaying"
          data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleAutoplaying"
          data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
      <div class="text-center">
        <h1> {{ event.title }}</h1>
      </div>
    </div>
    <div class="col-12  col-sm-12 col-md-6">
      <div class="card text-center">
        <div class="card-header">
          <div class="row d-flex justify-content-center">
            <span class="badge badge-theme">Active</span>
          </div>
        </div>
        <div class="card-body">
          <div class="card-title">
            <p class="fw-light">purchase a ticket for</p>
            <h1>${{event.cost}}</h1>
            <div>
              <p class="card-text">
              <p class="fw-bold"> {{ event.title }}</p>
              </p>
              <ul class="list-group list-group-flush">
                <li class="list-group-item"><i class="bi bi-person-fill"></i> {{event.remaining_tickets}} of
                  {{event.total_tickets}} seats remaining </li>
                <li class="list-group-item"><i class="bi-globe"> {{event.location}} </i></li>
                <li class="list-group-item"> <i class="bi bi-calendar-date"></i> {{event.date}} {{event.time}} </i>
                </li>
                <li class="list-group-item"> <i class="bi bi-gear-fill"></i> {{ event.game_system.name }} </i></li>

                <li class="list-group-item">
                  <p class="card-text">
                    <span class="badge badge-theme">All Ages</span> <span class="badge badge-theme">Combat
                      Focused</span> <span class="badge badge-theme">Amateur - Veteran Players</span>
                    <span class="badge badge-theme">One Shot</span> <span class="badge badge-theme">From Session
                      Zero</span> <span class="badge badge-theme">Homebrew Rules</span> <span
                      class="badge badge-theme">Open World</span>
                  </p>
                </li>
              </ul>

              <form action="" method="post" enctype="multipart/form-data">
                {{ comment_form.hidden_tag() }}
                <div class="d-flex justify-content-center padding">
                  <div class="input-group w-50">
                    {{ booking_form.amount(class_="form-control") }}
                  </div>
                </div>
                </ul>
                <div class="d-flex justify-content-center padding">
                  {{booking_form.submit(class_="form-control w-50")}}
                </div>
              </form>


              <!-- Modal -->
              <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel">Purchasing Tickets</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      You're Purchasing X tickets for $X.
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                      <button type="button" class="btn button-theme" data-bs-dismiss="modal">Confirm
                        Purchase</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <hr>
  <div class="row d-flex justify-content-center">
    <div class="col-6  col-sm-12 col-md-6">
      <h1> Description</h1>
      {{ event.description}}
    </div>

    <div class="col-12 col-md-6">
      <div class="text-center">
        <h1> Comments</h1>
        {% if current_user.is_authenticated %}
        <form action="" method="post" enctype="multipart/form-data">
          {{ comment_form.hidden_tag() }}
          <div class="col">
            {{ comment_form.message(class_ = 'form-control') }}
            <div class="col p-3">
              {{ comment_form.submit(class_ = 'form-control') }}
            </div>
        </form>
        {% else %}
        <div class="col">
          <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"
            readonly> You must be logged in to create comments</textarea>
          <div class="col p-3">
            <a href="/login" class="btn button-theme" role="button">Go to Login Page</a>
          </div>

          {% endif %}
        </div>
      </div>
      <hr>
      <div class="container">
        <div class="row row-cols-1">
          <div class="col">
            {%for comment in event.comments%}
            <div class="card border-dark mb-3">
              <div class="card-body">
                <h5 class="card-title">{{comment.user.username}} - posted at {{comment.format_datetime()}}</h5>
                <p class="card-text">
                  {{comment.message}}
                </p>

              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
{% endblock %}
</header>



<!-- Bootstrap CSS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
</main>

</body>

<footer>
  <div class="p-5 mb-4 bg-light rounded-3">
    <div class="container">
      <div class="row container-padding">
        <div class="col text-center">
          <a href="#" class="link-dark text-center">About us</a>
        </div>
        <div class="col text-center">
          <a href="#" class="link-dark text-center">Support</a>
        </div>
        <div class="col text-center">
          <a href="#" class="link-dark text-center">Careers</a>
        </div>
      </div>
      <hr>
      <div class="text-center">
        Lorem ipsum dolor sit amet consectetur adipisicing elit. Molestias quam laboriosam ex necessitatibus inventore
        distinctio sapiente totam pariatur recusandae porro rem in, maiores laudantium eligendi, rerum reiciendis,
        cupiditate vel asperiores. Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt perferendis nihil
        dignissimos unde eos cumque consectetur! Dolores, nulla recusandae! Consequatur pariatur mollitia veniam
        explicabo, fugiat exercitationem adipisci id nisi itaque.
      </div>
      <div class="text-center text-muted padding">
        Copyright Â© 2023 RollTables Pty Ltd
      </div>
    </div>
  </div>
</footer>

</html>